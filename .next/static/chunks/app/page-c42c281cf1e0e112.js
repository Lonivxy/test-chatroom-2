(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2206:function(e,s,r){Promise.resolve().then(r.bind(r,5515))},5515:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return G}});var a=r(7437),t=r(2265),n=r(7053),l=r(535),o=r(1994),i=r(3335);function d(){for(var e=arguments.length,s=Array(e),r=0;r<e;r++)s[r]=arguments[r];return(0,i.m6)((0,o.W)(s))}let c=(0,l.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function u(e){let{className:s,variant:r,size:t,asChild:l=!1,...o}=e,i=l?n.g7:"button";return(0,a.jsx)(i,{"data-slot":"button",className:d(c({variant:r,size:t,className:s})),...o})}function f(e){let{className:s,type:r,...t}=e;return(0,a.jsx)("input",{type:r,"data-slot":"input",className:d("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",s),...t})}function m(e){let{className:s,...r}=e;return(0,a.jsx)("div",{"data-slot":"card",className:d("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",s),...r})}var x=r(4930);function g(e){let{className:s,...r}=e;return(0,a.jsx)(x.fC,{"data-slot":"avatar",className:d("relative flex size-8 shrink-0 overflow-hidden rounded-full",s),...r})}function h(e){let{className:s,...r}=e;return(0,a.jsx)(x.NY,{"data-slot":"avatar-fallback",className:d("bg-muted flex size-full items-center justify-center rounded-full",s),...r})}let p=(0,l.j)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function b(e){let{className:s,variant:r,asChild:t=!1,...l}=e,o=t?n.g7:"span";return(0,a.jsx)(o,{"data-slot":"badge",className:d(p({variant:r}),s),...l})}var v=r(2841),j=r(2489);function N(e){let{...s}=e;return(0,a.jsx)(v.fC,{"data-slot":"dialog",...s})}function y(e){let{...s}=e;return(0,a.jsx)(v.xz,{"data-slot":"dialog-trigger",...s})}function w(e){let{...s}=e;return(0,a.jsx)(v.h_,{"data-slot":"dialog-portal",...s})}function k(e){let{className:s,...r}=e;return(0,a.jsx)(v.aV,{"data-slot":"dialog-overlay",className:d("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...r})}function S(e){let{className:s,children:r,showCloseButton:t=!0,...n}=e;return(0,a.jsxs)(w,{"data-slot":"dialog-portal",children:[(0,a.jsx)(k,{}),(0,a.jsxs)(v.VY,{"data-slot":"dialog-content",className:d("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...n,children:[r,t&&(0,a.jsxs)(v.x8,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(j.Z,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function C(e){let{className:s,...r}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:d("flex flex-col gap-2 text-center sm:text-left",s),...r})}function E(e){let{className:s,...r}=e;return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:d("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...r})}function O(e){let{className:s,...r}=e;return(0,a.jsx)(v.Dx,{"data-slot":"dialog-title",className:d("text-lg leading-none font-semibold",s),...r})}function U(e){let{className:s,...r}=e;return(0,a.jsx)(v.dk,{"data-slot":"dialog-description",className:d("text-muted-foreground text-sm",s),...r})}var z=r(6394);function P(e){let{className:s,...r}=e;return(0,a.jsx)(z.f,{"data-slot":"label",className:d("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...r})}var _=r(2449);function F(e){let{className:s,...r}=e;return(0,a.jsx)(_.fC,{"data-slot":"tabs",className:d("flex flex-col gap-2",s),...r})}function D(e){let{className:s,...r}=e;return(0,a.jsx)(_.aV,{"data-slot":"tabs-list",className:d("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",s),...r})}function I(e){let{className:s,...r}=e;return(0,a.jsx)(_.xz,{"data-slot":"tabs-trigger",className:d("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...r})}function R(e){let{className:s,...r}=e;return(0,a.jsx)(_.VY,{"data-slot":"tabs-content",className:d("flex-1 outline-none",s),...r})}var J=r(8728),Z=r(5868),T=r(3198),W=r(2805),L=r(5805),A=r(2718),M=r(6980),V=r(4743);function G(){let[e,s]=(0,t.useState)([]),[r,n]=(0,t.useState)(""),[l,o]=(0,t.useState)(null),[i,d]=(0,t.useState)([]),[c,x]=(0,t.useState)(null),[p,v]=(0,t.useState)(!1),[j,w]=(0,t.useState)(""),[k,z]=(0,t.useState)("#ea580c"),[_,G]=(0,t.useState)({name:"Orange",primary:"#ea580c",secondary:"#f97316",background:"#ffffff",foreground:"#4b5563",card:"#fffbeb",cardForeground:"#4b5563",sidebar:"#ffffff",sidebarForeground:"#4b5563"}),[Y,B]=(0,t.useState)(_),K=(0,t.useRef)(null),H=(0,t.useRef)(null),[q,Q]=(0,t.useState)(null),[X,$]=(0,t.useState)("disconnected"),[ee,es]=(0,t.useState)("ws://localhost:8080"),[er,ea]=(0,t.useState)("ws://localhost:8080"),et=e=>{let s=document.documentElement;s.style.setProperty("--primary",e.primary),s.style.setProperty("--secondary",e.secondary),s.style.setProperty("--background",e.background),s.style.setProperty("--foreground",e.foreground),s.style.setProperty("--card",e.card),s.style.setProperty("--card-foreground",e.cardForeground),s.style.setProperty("--sidebar",e.sidebar),s.style.setProperty("--sidebar-foreground",e.sidebarForeground),s.style.setProperty("--sidebar-primary",e.card),s.style.setProperty("--sidebar-primary-foreground",e.cardForeground),s.style.setProperty("--sidebar-accent",e.secondary),s.style.setProperty("--sidebar-accent-foreground",e.background)};(0,t.useEffect)(()=>{(async()=>{try{let e;let r="192.168.1.".concat(Math.floor(255*Math.random())),a=localStorage.getItem("chatUser");a?e=JSON.parse(a):(e={id:crypto.randomUUID(),name:r,ip:r,color:"#ea580c",isOnline:!0},localStorage.setItem("chatUser",JSON.stringify(e))),o(e);let t=()=>{console.log("[v0] Attempting to connect to WebSocket server:",ee),$("connecting");let r=new WebSocket(ee);r.onopen=()=>{console.log("[v0] WebSocket connected successfully"),$("connected"),Q(r),r.send(JSON.stringify({type:"USER_JOINED",data:e}))},r.onmessage=e=>{let{type:r,data:a}=JSON.parse(e.data);switch(console.log("[v0] Received WebSocket message:",r,a),r){case"USER_JOINED":d(e=>e.find(e=>e.id===a.id)?e.map(e=>e.id===a.id?{...a,isOnline:!0}:e):[...e,{...a,isOnline:!0}]);break;case"USER_LEFT":d(e=>e.map(e=>e.id===a.id?{...e,isOnline:!1}:e));break;case"NEW_MESSAGE":s(e=>e.some(e=>e.id===a.id)?e:[...e,a]);break;case"USER_UPDATED":d(e=>e.map(e=>e.id===a.id?a:e));break;case"USERS_LIST":d(a);break;case"MESSAGES_HISTORY":s(a)}},r.onclose=()=>{console.log("[v0] WebSocket connection closed"),$("disconnected"),Q(null),setTimeout(()=>{"visible"===document.visibilityState&&t()},3e3)},r.onerror=e=>{console.error("[v0] WebSocket error:",e),$("disconnected")}};t();let n=localStorage.getItem("chatMessages");n&&s(JSON.parse(n));let l=localStorage.getItem("chatTheme");if(l){let e=JSON.parse(l);G(e),B(e),et(e)}else et(_);let i=localStorage.getItem("chatServerUrl");i&&(es(i),ea(i));let c=()=>{q&&q.readyState===WebSocket.OPEN&&q.send(JSON.stringify({type:"USER_LEFT",data:e}))};return window.addEventListener("beforeunload",c),()=>{window.removeEventListener("beforeunload",c),q&&q.close()}}catch(e){console.error("Error initializing user:",e)}})()},[ee]),(0,t.useEffect)(()=>{var e;null===(e=K.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[e]),(0,t.useEffect)(()=>{e.length>0&&localStorage.setItem("chatMessages",JSON.stringify(e))},[e]),(0,t.useEffect)(()=>{i.length>0&&localStorage.setItem("sharedChatUsers",JSON.stringify(i))},[i]);let en=()=>{if(!l||!r.trim()&&!c||!q||q.readyState!==WebSocket.OPEN)return;let e={id:crypto.randomUUID(),text:c?"Shared file: ".concat(c.name):r,sender:l.name,timestamp:new Date,type:c?"file":"text",fileName:null==c?void 0:c.name,fileUrl:c?URL.createObjectURL(c):void 0};q.send(JSON.stringify({type:"NEW_MESSAGE",data:e})),n(""),x(null),H.current&&(H.current.value="")},el=e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),eo=()=>{l&&(w(l.name),z(l.color),B(_),ea(ee),v(!0))},ei=e=>{B(e)},ed=(e,s)=>{B(r=>({...r,[e]:s}))};return l?(0,a.jsxs)("div",{className:"flex h-screen bg-background",children:[(0,a.jsxs)("div",{className:"w-80 bg-sidebar border-r border-sidebar-border flex flex-col",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-sidebar-border",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("connected"===X?"bg-green-500":"connecting"===X?"bg-yellow-500 animate-pulse":"bg-red-500")}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"connected"===X?"Connected":"connecting"===X?"Connecting...":"Disconnected"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)(g,{className:"h-10 w-10",children:(0,a.jsx)(h,{style:{backgroundColor:l.color},children:l.name.slice(0,2).toUpperCase()})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h2",{className:"font-semibold text-sidebar-foreground",children:l.name}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:l.ip})]}),(0,a.jsxs)(N,{open:p,onOpenChange:v,children:[(0,a.jsx)(y,{asChild:!0,children:(0,a.jsx)(u,{variant:"ghost",size:"icon",onClick:eo,children:(0,a.jsx)(J.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)(S,{className:"sm:max-w-[500px] max-h-[80vh] overflow-y-auto",children:[(0,a.jsxs)(C,{children:[(0,a.jsxs)(O,{className:"flex items-center gap-2",children:[(0,a.jsx)(J.Z,{className:"h-5 w-5"}),"Settings"]}),(0,a.jsx)(U,{children:"Customize your profile and app theme. All changes are saved locally."})]}),(0,a.jsxs)(F,{defaultValue:"user",className:"w-full",children:[(0,a.jsxs)(D,{className:"grid w-full grid-cols-3",children:[(0,a.jsxs)(I,{value:"user",className:"flex items-center gap-2",children:[(0,a.jsx)(Z.Z,{className:"h-4 w-4"}),"Profile"]}),(0,a.jsx)(I,{value:"server",className:"flex items-center gap-2",children:"\uD83C\uDF10 Server"}),(0,a.jsxs)(I,{value:"theme",className:"flex items-center gap-2",children:[(0,a.jsx)(T.Z,{className:"h-4 w-4"}),"Theme"]})]}),(0,a.jsxs)(R,{value:"user",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsxs)(P,{htmlFor:"name",className:"flex items-center gap-2",children:[(0,a.jsx)(Z.Z,{className:"h-4 w-4"}),"Display Name"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(f,{id:"name",value:j,onChange:e=>w(e.target.value),placeholder:"Enter your display name",className:"flex-1"}),(0,a.jsx)(u,{variant:"outline",size:"sm",onClick:()=>{l&&w(l.ip)},children:"Use IP"})]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Leave empty to use your IP address (",null==l?void 0:l.ip,")"]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsxs)(P,{className:"flex items-center gap-2",children:[(0,a.jsx)(W.Z,{className:"h-4 w-4"}),"Avatar Color"]}),(0,a.jsx)("div",{className:"grid grid-cols-5 gap-2",children:["#ea580c","#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#f97316","#84cc16","#ec4899"].map(e=>(0,a.jsx)("button",{onClick:()=>z(e),className:"w-10 h-10 rounded-full border-2 transition-all hover:scale-110 ".concat(k===e?"border-foreground shadow-lg":"border-border"),style:{backgroundColor:e},title:e},e))}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)(g,{className:"h-8 w-8",children:(0,a.jsx)(h,{style:{backgroundColor:k},children:(j||(null==l?void 0:l.ip)||"").slice(0,2).toUpperCase()})}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Preview"})]})]})]}),(0,a.jsx)(R,{value:"server",className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(P,{htmlFor:"serverUrl",className:"flex items-center gap-2",children:"\uD83C\uDF10 WebSocket Server URL"}),(0,a.jsx)(f,{id:"serverUrl",value:er,onChange:e=>ea(e.target.value),placeholder:"ws://localhost:8080",className:"flex-1"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Change this to connect to a different server. Ask your friend for their server URL."}),(0,a.jsxs)("div",{className:"mt-2 p-2 bg-muted rounded text-xs",children:[(0,a.jsx)("p",{className:"font-medium mb-1",children:"Connection Status:"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("connected"===X?"bg-green-500":"connecting"===X?"bg-yellow-500":"bg-red-500")}),(0,a.jsx)("span",{children:X})]})]})]})}),(0,a.jsx)(R,{value:"theme",className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(P,{className:"text-sm font-medium mb-3 block",children:"Theme Presets"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:[{name:"Orange",primary:"#ea580c",secondary:"#f97316",background:"#ffffff",foreground:"#4b5563",card:"#fffbeb",cardForeground:"#4b5563",sidebar:"#ffffff",sidebarForeground:"#4b5563"},{name:"Blue",primary:"#3b82f6",secondary:"#60a5fa",background:"#ffffff",foreground:"#1f2937",card:"#eff6ff",cardForeground:"#1f2937",sidebar:"#f8fafc",sidebarForeground:"#1f2937"},{name:"Green",primary:"#10b981",secondary:"#34d399",background:"#ffffff",foreground:"#1f2937",card:"#ecfdf5",cardForeground:"#1f2937",sidebar:"#f0fdf4",sidebarForeground:"#1f2937"},{name:"Purple",primary:"#8b5cf6",secondary:"#a78bfa",background:"#ffffff",foreground:"#1f2937",card:"#f5f3ff",cardForeground:"#1f2937",sidebar:"#faf5ff",sidebarForeground:"#1f2937"},{name:"Dark",primary:"#f97316",secondary:"#fb923c",background:"#1f2937",foreground:"#f9fafb",card:"#374151",cardForeground:"#f9fafb",sidebar:"#111827",sidebarForeground:"#f9fafb"}].map(e=>(0,a.jsxs)(u,{variant:Y.name===e.name?"default":"outline",size:"sm",onClick:()=>ei(e),className:"justify-start",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full mr-2",style:{backgroundColor:e.primary}}),e.name]},e.name))})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(P,{className:"text-sm font-medium",children:"Custom Colors"}),(0,a.jsxs)("div",{className:"grid gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(P,{className:"text-xs w-20",children:"Primary"}),(0,a.jsx)("input",{type:"color",value:Y.primary,onChange:e=>ed("primary",e.target.value),className:"w-12 h-8 rounded border border-border cursor-pointer"}),(0,a.jsx)(f,{value:Y.primary,onChange:e=>ed("primary",e.target.value),className:"flex-1 text-xs",placeholder:"#ea580c"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(P,{className:"text-xs w-20",children:"Secondary"}),(0,a.jsx)("input",{type:"color",value:Y.secondary,onChange:e=>ed("secondary",e.target.value),className:"w-12 h-8 rounded border border-border cursor-pointer"}),(0,a.jsx)(f,{value:Y.secondary,onChange:e=>ed("secondary",e.target.value),className:"flex-1 text-xs",placeholder:"#f97316"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(P,{className:"text-xs w-20",children:"Background"}),(0,a.jsx)("input",{type:"color",value:Y.background,onChange:e=>ed("background",e.target.value),className:"w-12 h-8 rounded border border-border cursor-pointer"}),(0,a.jsx)(f,{value:Y.background,onChange:e=>ed("background",e.target.value),className:"flex-1 text-xs",placeholder:"#ffffff"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(P,{className:"text-xs w-20",children:"Text"}),(0,a.jsx)("input",{type:"color",value:Y.foreground,onChange:e=>ed("foreground",e.target.value),className:"w-12 h-8 rounded border border-border cursor-pointer"}),(0,a.jsx)(f,{value:Y.foreground,onChange:e=>ed("foreground",e.target.value),className:"flex-1 text-xs",placeholder:"#4b5563"})]})]})]})]})})]}),(0,a.jsxs)(E,{children:[(0,a.jsx)(u,{variant:"outline",onClick:()=>v(!1),children:"Cancel"}),(0,a.jsx)(u,{onClick:()=>{if(!l)return;let e={...l,name:j.trim()||l.ip,color:k};o(e),localStorage.setItem("chatUser",JSON.stringify(e)),q&&q.readyState===WebSocket.OPEN&&q.send(JSON.stringify({type:"USER_UPDATED",data:e})),G(Y),localStorage.setItem("chatTheme",JSON.stringify(Y)),et(Y),es(er),localStorage.setItem("chatServerUrl",er),v(!1)},children:"Save Changes"})]})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(u,{variant:"outline",size:"sm",className:"flex-1 bg-transparent",children:[(0,a.jsx)(L.Z,{className:"h-4 w-4 mr-2"}),"Users (",i.filter(e=>e.isOnline).length,")"]}),(0,a.jsxs)(u,{variant:"outline",size:"sm",className:"flex-1 bg-transparent",children:[(0,a.jsx)(A.Z,{className:"h-4 w-4 mr-2"}),"Chat"]})]})]}),(0,a.jsxs)("div",{className:"flex-1 p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-sidebar-foreground mb-3",children:"Online Users"}),"connected"!==X&&(0,a.jsxs)("div",{className:"text-center py-4",children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"connecting"===X?"Connecting to server...":"Server disconnected"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Make sure the WebSocket server is running on localhost:8080"})]}),(0,a.jsx)("div",{className:"space-y-2",children:i.filter(e=>e.isOnline).map(e=>{var s;return(0,a.jsxs)("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-sidebar-accent/10 transition-colors",children:[(0,a.jsx)(g,{className:"h-8 w-8",children:(0,a.jsx)(h,{style:{backgroundColor:(null===(s=i.find(s=>s.name===e.name))||void 0===s?void 0:s.color)||"#ea580c"},children:e.name.slice(0,2).toUpperCase()})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-sidebar-foreground truncate",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.ip})]}),e.isOnline&&(0,a.jsx)(b,{variant:"secondary",className:"bg-green-100 text-green-800 text-xs",children:"Online"})]},e.id)})})]})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,a.jsx)("div",{className:"p-4 border-b border-border bg-card",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-semibold text-card-foreground",children:"General Chat"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[i.filter(e=>e.isOnline).length," users online","connected"!==X&&(0,a.jsx)("span",{className:"text-red-500 ml-2",children:"• Server disconnected"})]})]}),(0,a.jsx)(N,{open:p,onOpenChange:v,children:(0,a.jsx)(y,{asChild:!0,children:(0,a.jsxs)(u,{variant:"outline",size:"sm",onClick:eo,children:[(0,a.jsx)(J.Z,{className:"h-4 w-4 mr-2"}),"Settings"]})})})]})}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:["connected"!==X&&(0,a.jsxs)("div",{className:"text-center py-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-yellow-800 mb-2",children:"⚠️ Not connected to chat server"}),(0,a.jsx)("p",{className:"text-xs text-yellow-600",children:"Messages will not be sent until connection is restored"})]}),0===e.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(A.Z,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"No messages yet. Start the conversation!"})]}):e.map(e=>{var s;return(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(g,{className:"h-8 w-8 flex-shrink-0",children:(0,a.jsx)(h,{style:{backgroundColor:(null===(s=i.find(s=>s.name===e.sender))||void 0===s?void 0:s.color)||"#ea580c"},children:e.sender.slice(0,2).toUpperCase()})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-foreground",children:e.sender}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:el(e.timestamp)})]}),(0,a.jsx)(m,{className:"p-3 bg-card border-border",children:"file"===e.type?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(M.Z,{className:"h-4 w-4 text-primary"}),(0,a.jsx)("span",{className:"text-sm text-card-foreground",children:e.fileName}),e.fileUrl&&(0,a.jsx)(u,{variant:"link",size:"sm",asChild:!0,className:"p-0 h-auto",children:(0,a.jsx)("a",{href:e.fileUrl,download:e.fileName,className:"text-primary",children:"Download"})})]}):(0,a.jsx)("p",{className:"text-sm text-card-foreground whitespace-pre-wrap",children:e.text})})]})]},e.id)}),(0,a.jsx)("div",{ref:K})]}),(0,a.jsxs)("div",{className:"p-4 border-t border-border bg-background",children:[c&&(0,a.jsxs)("div",{className:"mb-3 p-2 bg-muted rounded-lg flex items-center gap-2",children:[(0,a.jsx)(M.Z,{className:"h-4 w-4 text-primary"}),(0,a.jsx)("span",{className:"text-sm text-foreground flex-1",children:c.name}),(0,a.jsx)(u,{variant:"ghost",size:"sm",onClick:()=>{x(null),H.current&&(H.current.value="")},children:"Remove"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"file",ref:H,onChange:e=>{var s;let r=null===(s=e.target.files)||void 0===s?void 0:s[0];r&&x(r)},className:"hidden",accept:"*/*"}),(0,a.jsx)(u,{variant:"outline",size:"icon",onClick:()=>{var e;return null===(e=H.current)||void 0===e?void 0:e.click()},className:"flex-shrink-0",children:(0,a.jsx)(M.Z,{className:"h-4 w-4"})}),(0,a.jsx)(f,{value:r,onChange:e=>n(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),en())},placeholder:"Type your message...",className:"flex-1 bg-input border-border"}),(0,a.jsx)(u,{onClick:en,disabled:!r.trim()&&!c||"connected"!==X,className:"flex-shrink-0",children:(0,a.jsx)(V.Z,{className:"h-4 w-4"})})]})]})]})]}):(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-background",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Initializing chat..."})]})})}}},function(e){e.O(0,[718,971,117,744],function(){return e(e.s=2206)}),_N_E=e.O()}]);